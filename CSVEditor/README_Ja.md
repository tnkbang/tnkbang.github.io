# CSV Editor

<div align="center">

![CSV Editor](https://img.shields.io/badge/CSV-Editor-blue)
![.NET 8](https://img.shields.io/badge/.NET-8.0-purple)
![Windows](https://img.shields.io/badge/Platform-Windows-lightgrey)
![License](https://img.shields.io/badge/License-MIT-green)

.NET 8とWindows Formsで構築された強力で機能豊富なCSVファイルエディタ

[English](README.md) | [Tiếng Việt](README_Vi.md)

</div>

---

## 📖 概要

CSV Editorは、大規模なCSVファイルを簡単に表示、編集、管理できるように設計された高性能デスクトップアプリケーションです。.NET 8上に構築され、データ操作、フィルタリング、検索などの高度な機能を備えた直感的なExcelライクなインターフェイスを提供します。

### ✨ 主な強み

- **高性能**: 効率的なメモリ管理と並列処理により、大規模なデータセット（数百万セル）の処理に最適化
- **高度なデータグリッド**: スムーズなスクロールと編集のための仮想化モードを備えたカスタムDataGrid実装
- **インテリジェントメモリ**: メモリ効率的な文字列重複排除のためのStringPoolとPooledStringTable
- **完全な元に戻す/やり直し**: 無制限の元に戻す/やり直し履歴（最大100ステップ）を備えた完全なコマンドパターン実装
- **多言語サポート**: 組み込みのローカライゼーション（ベトナム語、英語、日本語）
- **モダンUI**: DPI認識とズーム機能を備えたクリーンで直感的なインターフェイス

---

## ⌨️ キーボードショートカット

CSV Editorのすべてのキーボードショートカットのクイックリファレンス：

### ファイル操作
| ショートカット | 機能 | 説明 |
|----------|----------|-------------|
| `Ctrl + N` | 新規ファイル | カスタムサイズの新しいCSVファイルを作成 |
| `Ctrl + O` | ファイルを開く | 既存のCSVファイルを開く |
| `Ctrl + S` | 保存 | 現在のファイルを保存 |
| `Ctrl + Shift + S` | 名前を付けて保存 | 新しい名前で現在のファイルを保存 |
| `Ctrl + E` | Excelにエクスポート | 現在のデータをExcel形式（.xlsx）にエクスポート |
| `Ctrl + W` | ファイルを閉じる | 現在のファイルを閉じる |

### 編集操作
| ショートカット | 機能 | 説明 |
|----------|----------|-------------|
| `Ctrl + Z` | 元に戻す | 最後の操作を元に戻す |
| `Ctrl + Y` | やり直し | 最後に元に戻した操作をやり直す |
| `Ctrl + Shift + Z` | やり直し | 最後に元に戻した操作をやり直す（代替） |
| `F2` | セル編集 | 現在のセルの編集モードに入る |
| `Delete` / `Backspace` | セルクリア | 選択したセルの内容をクリア |
| `Ctrl + C` | コピー | 選択したセルをコピー |
| `Ctrl + X` | 切り取り | 選択したセルを切り取り（内容をクリア） |
| `Ctrl + V` | 貼り付け | 現在のセルからクリップボードの内容を貼り付け |

### 表示操作
| ショートカット | 機能 | 説明 |
|----------|----------|-------------|
| `Ctrl + F` | 検索と置換 | 検索と置換ダイアログを開く |
| `Ctrl + H` | 検索と置換 | 検索と置換ダイアログを開く（代替） |
| `F3` | 次を検索 | 次の一致を検索（検索ダイアログが開いている場合） |
| `Shift + F3` | 前を検索 | 前の一致を検索（検索ダイアログが開いている場合） |
| `Esc` | 検索ダイアログを閉じる | 検索と置換ダイアログを閉じる |
| `Ctrl + Q` | 引用符の切り替え | セル内の引用符の表示/非表示を切り替え |
| `Ctrl + R` | 列のリサイズ | すべての列を内容に合わせて自動リサイズ |

### ズーム操作
| ショートカット | 機能 | 説明 |
|----------|----------|-------------|
| `Ctrl + プラス (+)` | ズームイン | ズームレベルを25%増加 |
| `Ctrl + マイナス (-)` | ズームアウト | ズームレベルを25%減少 |
| `Ctrl + 0` | ズームリセット | ズームを100%にリセット |
| `Ctrl + マウスホイール` | ズームイン/アウト | ズームイン（上スクロール）またはズームアウト（下スクロール） |

### 行操作
| ショートカット | 機能 | 説明 |
|----------|----------|-------------|
| `Ctrl + Insert` | 行の挿入 | 現在の位置に新しい行を挿入 |
| `Ctrl + H` | 行の非表示 | 選択した行を非表示 |

### ナビゲーション
| ショートカット | 機能 | 説明 |
|----------|----------|-------------|
| `矢印キー` | セル移動 | セル間を移動 |
| `Tab` | 右に移動 | 次のセル（右）に移動 |
| `Shift + Tab` | 左に移動 | 前のセル（左）に移動 |
| `Enter` | 下に移動 | 下のセルに移動 |
| `Home` | 最初の列 | 現在の行の最初の列に移動 |
| `End` | 最後の列 | 現在の行の最後の列に移動 |
| `Ctrl + Home` | 最初のセル | 最初のセル（左上隅）に移動 |
| `Ctrl + End` | 最後のセル | 最後のセル（右下隅）に移動 |
| `Page Up` | 上にスクロール | 1画面上にスクロール |
| `Page Down` | 下にスクロール | 1画面下にスクロール |

### 注意
- ほとんどのショートカットは標準のWindowsの規則に従います
- ショートカットは大文字と小文字を区別しません（特に指定がない限り）
- 一部のショートカットは、グリッドが読み取り専用モードまたはデータ処理中の場合は無効になる場合があります
- 検索と置換ダイアログが開いている場合、`Esc`を押すとダイアログが閉じ、グリッドにフォーカスが戻ります

---

## 🚀 機能

### ファイル操作

#### 新規ファイル
カスタムサイズの新しいCSVファイルを作成します。

**使用方法:**
1. **File → New**をクリックするか、**`Ctrl+N`**を押す
2. 行数と列数を入力
3. データの編集を開始

**ショートカット:** `Ctrl+N`

#### ファイルを開く
自動エンコーディング検出でCSVファイルを開いて読み込みます。

**使用方法:**
1. **File → Open**をクリックするか、**`Ctrl+O`**を押す
2. CSVファイルを選択
3. アプリケーションが自動的にエンコーディングと区切り文字を検出

**ショートカット:** `Ctrl+O`

**サポートされる形式:**
- CSV（カンマ区切り値）
- TSV（タブ区切り値）
- カスタム区切り文字ファイル

#### 保存 / 名前を付けて保存
既存のファイルに変更を保存するか、新しいファイルにエクスポートします。

**使用方法:**
- **保存:** **`Ctrl+S`**を押して現在のファイルに保存
- **名前を付けて保存:** **`Ctrl+Shift+S`**を押して新しいファイルとして保存

**ショートカット:**
- 保存: `Ctrl+S`
- 名前を付けて保存: `Ctrl+Shift+S`

#### ファイルを閉じる
現在のファイルを閉じてグリッドをクリアします。

**ショートカット:** `Ctrl+W`

#### Excelにエクスポート
CSVデータをExcel形式（.xlsx）にエクスポートします。

**使用方法:**
1. **File → Export to Excel**をクリックするか、**`Ctrl+E`**を押す
2. 保存場所を選択
3. データが最適な列幅でエクスポートされます

**ショートカット:** `Ctrl+E`

#### ファイルの結合
複数のCSVファイルを1つに結合します。

**使用方法:**
1. **File → Merge Files**をクリック
2. 複数のCSVファイルを選択
3. ファイルが行ごとに自動列配置で結合されます

**機能:**
- 自動列配置
- 大きなファイルの進行状況バー
- 異なる列数の処理

#### ファイルの暗号化
暗号化保護でファイルを開いて保存します。

**使用方法:**
- **暗号化されたファイルを開く:** File → Open with Encryption
- **暗号化して保存:** File → Save with Encryption

---

### 編集操作

#### 元に戻す / やり直し
完全な履歴サポートで変更を元に戻すか再適用します。

**ショートカット:**
- 元に戻す: `Ctrl+Z`
- やり直し: `Ctrl+Y`または`Ctrl+Shift+Z`

**サポートされる操作:**
- セル値の変更
- 行/列の挿入と削除
- 非表示/表示操作
- フィルター操作
- 固定/固定解除
- ハイライト

#### セル編集
グリッド内で直接セル値を編集します。

**使用方法:**
1. セルを選択
2. **`F2`**を押すかダブルクリックして編集
3. 新しい値を入力
4. **`Enter`**を押して確認するか、**`Esc`**を押してキャンセル

**ショートカット:**
- 編集: `F2`またはダブルクリック
- 複数セル編集: セルを選択 → `Delete`を押すかデータを貼り付け

#### コピー / 貼り付け
複数セルサポートを備えた標準のクリップボード操作。

**使用方法:**
- **コピー:** セルを選択 → `Ctrl+C`
- **切り取り:** セルを選択 → `Ctrl+X`
- **貼り付け:** 開始セルを選択 → `Ctrl+V`

**機能:**
- 複数セルのコピー/貼り付け
- タブ区切り形式の保持
- 自動リサイズでスマート貼り付け

#### セル内容の削除
選択したセルから内容をクリアします。

**使用方法:**
1. セルを選択
2. **`Delete`**または**`Backspace`**を押す

**ショートカット:** `Delete`または`Backspace`

---

### 行操作

#### 行の挿入
現在の位置に新しい行を追加します。

**使用方法:**
1. 行ヘッダーを右クリック
2. **Insert Row**または**Insert Rows**を選択
3. 挿入する行数を入力（一括挿入の場合）

**ショートカット:** `Ctrl+Insert`

#### 行の削除
選択した行を削除します。

**使用方法:**
1. 行ヘッダーをクリックして行を選択
2. 右クリック → **Delete Selected Rows**
3. 削除を確認

**機能:**
- 複数行選択（クリック + Shift/Ctrl）
- 元に戻すサポート

#### 行の非表示 / 再表示
一時的にビューから行を非表示にします。

**使用方法:**
- **非表示:** 行を選択 → 右クリック → **Hide Selected Rows**または`Ctrl+H`
- **再表示:** 右クリック → **Unhide Selected Rows**
- **すべて再表示:** 右クリック → **Unhide All Rows**

**ショートカット:**
- 非表示: `Ctrl+H`

**注意:** 非表示の行はファイル保存時に保持されます

#### 行の固定 / 固定解除
ビューの上部に行をロックします。

**使用方法:**
1. 固定する行を選択
2. 右クリック → **Freeze Row**
3. 固定された行はスクロール時も表示されたままになります

**固定解除するには:**
- 固定領域を右クリック → **Unfreeze Row**

**機能:**
- 単一行の固定（その行とその上のすべての行）
- 固定された行の視覚的インジケータ
- ズーム中も保持

---

### 列操作

#### 列の挿入
現在の位置に新しい列を追加します。

**使用方法:**
1. 列ヘッダーを右クリック
2. **Insert Column**または**Insert Columns**を選択
3. 挿入する列数を入力

#### 列の削除
選択した列を削除します。

**使用方法:**
1. 列ヘッダーをクリックして列を選択
2. 右クリック → **Delete Selected Columns**
3. 削除を確認

#### 列の非表示 / 再表示
一時的にビューから列を非表示にします。

**使用方法:**
- **非表示:** 列を選択 → 右クリック → **Hide Selected Columns**
- **再表示:** 右クリック → **Unhide Selected Columns**
- **すべて再表示:** 右クリック → **Unhide All Columns**

#### 列の固定 / 固定解除
ビューの左側に列をロックします。

**使用方法:**
1. 固定する列を選択
2. 右クリック → **Freeze Column**
3. 固定された列は水平スクロール時も表示されたままになります

**固定解除するには:**
- 固定領域を右クリック → **Unfreeze Column**

#### 列幅の自動調整
内容に合わせて列幅を自動調整します。

**使用方法:**
- **View → Resize Columns**をクリックするか、**`Ctrl+R`**を押す
- または列の区切り線をダブルクリック

**ショートカット:** `Ctrl+R`

**機能:**
- すべての列の最適な幅を計算
- 大規模なデータセットの進行状況インジケータ

#### 列ヘッダースタイル
列ヘッダーの表示方法を選択します。

**使用方法:**
1. **View → Column Header Style**をクリック
2. 以下から選択:
   - **Number:** 1, 2, 3...
   - **Excel Style:** A, B, C... AA, AB...
   - **CSV Header:** 最初の行をヘッダーとして使用

**機能:**
- CSVヘッダーモードは最初の行をヘッダーとして扱います（編集不可）
- ヘッダースタイルは設定に保存されます

---

### データ操作

#### 検索と置換
強力な検索と置換機能。

**使用方法:**
1. **`Ctrl+F`**または**`Ctrl+H`**を押す
2. 検索テキストを入力
3. 検索モードを選択:
   - **Accurate:** 完全一致
   - **Contains:** 部分一致
   - **Starts With:** 先頭一致
   - **Ends With:** 末尾一致
4. オプション:
   - **Find Only Column:** 現在の列のみを検索
5. **Find Next**または**Find Previous**をクリック

**ショートカット:**
- 検索を開く: `Ctrl+F`または`Ctrl+H`
- 次を検索: `F3`または**Find Next**をクリック
- 前を検索: `Shift+F3`または**Find Previous**をクリック
- 置換: **Replace**をクリック
- すべて置換: **Replace All**をクリック
- 閉じる: `Esc`

**機能:**
- すべての一致をハイライト
- 一致数を表示
- 単一またはすべての出現を置換
- 大規模なデータセットの高速並列検索

#### 列のフィルタ
Excelライクな列フィルタリング。

**使用方法:**
1. 列ヘッダーを右クリック
2. **Filter Column**を選択
3. 表示/非表示にする値を選択
4. 名前または数でソート
5. **Submit**をクリック

**フィルタをクリアするには:**
- 右クリック → **Clear Filter**

**機能:**
- 複数選択フィルタリング
- フィルタ値内の検索
- 名前または数による昇順/降順ソート
- 各値のアイテム数を表示
- 複数の列にフィルタを組み合わせ

#### データのソート
列の値で行をソートします。

**使用方法:**
1. 列ヘッダーを右クリック
2. ソートモードを選択:
   - **Ascending:** A → Z, 0 → 9
   - **Descending:** Z → A, 9 → 0
   - **Natural:** 自然数ソート（1, 10, 2ではなく1, 2, 10）
   - **Shuffle:** ランダム順序

**機能:**
- 複数のソートアルゴリズム
- 行の整合性を保持
- フィルタされたデータで動作

---

### 表示操作

#### ズームイン / ズームアウト
より良い視認性のためにビューサイズを調整します。

**使用方法:**
- **ズームイン:** **+**ボタンをクリックするか、**`Ctrl++`**を押す
- **ズームアウト:** **-**ボタンをクリックするか、**`Ctrl+-`**を押す
- **ズームリセット:** **`Ctrl+0`**を押す
- **カスタム設定:** ズーム率をクリック → 値を入力

**ショートカット:**
- ズームイン: `Ctrl++`または`Ctrl+マウスホイール上`
- ズームアウト: `Ctrl+-`または`Ctrl+マウスホイール下`
- リセット: `Ctrl+0`

**ズーム範囲:** 50%から500%まで25%刻み

**機能:**
- フォント、行の高さ、列幅をスケール
- スクロール位置を保持
- レイアウトを動的に再計算

#### 引用符
セル内の引用符の表示を切り替えます。

**使用方法:**
- **View → Quote Marks**をクリックするか、**`Ctrl+Q`**を押す

**ショートカット:** `Ctrl+Q`

**機能:**
- 引用符を追加: セルを選択 → 右クリック → **Add Quote Marks**
- 引用符を削除: セルを選択 → 右クリック → **Remove Quote Marks**

---

### ハイライト操作

#### ハイライトの追加
背景色で重要なセルをマークします。

**使用方法:**
1. セルを選択
2. 右クリック → **Add Highlight**

**機能:**
- セッション間で永続
- 元に戻す/やり直しサポート
- 視覚的なセルマーキング

#### ハイライトの削除
選択したセルからハイライトを削除します。

**使用方法:**
1. ハイライトされたセルを選択
2. 右クリック → **Remove Highlight**

#### すべてのハイライトをクリア
グリッドからすべてのハイライトを削除します。

**使用方法:**
- 右クリック → **Clear All Highlights**

---

### 設定

#### エンコーディング
ファイル操作の文字エンコーディングを設定します。

**使用方法:**
1. **Settings → Encoding**をクリック
2. UTF-8、Shift-JISなどから選択

**機能:**
- ファイルを開くときに自動検出
- セッションごとに保持

#### 区切り文字
フィールド区切り文字を設定します。

**使用方法:**
1. **Settings → Delimiter**をクリック
2. 以下から選択:
   - カンマ (`,`)
   - タブ (`\t`)
   - セミコロン (`;`)
   - パイプ (`|`)
   - カスタム

**機能:**
- ファイルの開く/保存時に適用
- カスタム区切り文字をサポート

#### 言語
ベトナム語、英語、日本語を切り替えます。

**使用方法:**
1. **Settings → Language**をクリック
2. **Vietnamese**、**English**、または**Japanese**を選択

**機能:**
- 即座にUIを更新
- 設定に保存

---

## 🛠️ システム要件

- **オペレーティングシステム:** Windows 10以降
- **フレームワーク:** .NET 8.0ランタイム
- **メモリ:** 最低4 GB RAM（大きなファイルには8 GB推奨）
- **ディスクスペース:** 50 MB

---

## 📦 インストール

1. [Releases](https://github.com/tnkbang/CSVEditor/releases)から最新リリースをダウンロード
2. ZIPファイルを解凍
3. `CSVEditor.exe`を実行

**インストール不要！** アプリケーションはポータブルです。

---

## 🖱️ 使用のヒント

### 選択
- **単一セル:** セルをクリック
- **複数セル:** クリック + ドラッグ、またはShift+クリック
- **行全体:** 行ヘッダーをクリック
- **列全体:** 列ヘッダーをクリック
- **複数の行/列:** 非連続の場合はクリック + Ctrl、範囲の場合はShift

### ドラッグ＆ドロップ
- CSVファイルをアプリケーションウィンドウに直接ドラッグして開く
- 複数のファイルは別々のウィンドウで開きます

### コンテキストメニュー
- セル、行、または列を右クリックして操作にすばやくアクセス

### キーボードナビゲーション
- **矢印キー:** セル間を移動
- **Tab:** 次のセルに移動
- **Enter:** 下のセルに移動
- **Page Up/Down:** 1画面スクロール
- **Home/End:** 行の最初/最後のセルに移動
- **Ctrl+Home/End:** グリッドの最初/最後のセルに移動

---

## 🔧 技術詳細

### アーキテクチャ
- **カスタムDataGrid:** 高性能仮想化グリッド
- **コマンドパターン:** 完全な元に戻す/やり直しシステム
- **StringPool:** メモリ効率的な文字列重複排除
- **並列処理:** 大規模なデータセットの高速検索とデータ操作

### 依存関係
- **.NET 8.0:** コアフレームワーク
- **MiniExcel:** Excelエクスポート機能
- **Windows Forms:** UIフレームワーク

---

## 📝 ライセンス

このプロジェクトはMITライセンスの下でライセンスされています - 詳細は[LICENSE](LICENSE)ファイルを参照してください。

---

## 🤝 貢献

貢献を歓迎します！お気軽にプルリクエストを送信してください。

---

## 📧 連絡先

- **GitHub:** [tnkbang/CSVEditor](https://github.com/tnkbang/CSVEditor)
- **Issues:** [バグを報告](https://github.com/tnkbang/CSVEditor/issues)

---

## 🙏 謝辞

- Excelエクスポート機能のためのMiniExcelライブラリ
- 優れたフレームワークとツールのための.NETコミュニティ

---

<div align="center">

.NET 8で❤️を込めて作成

</div>
